import{_ as i,c as a,o as n,ae as p}from"./chunks/framework.CLNW5JS9.js";const E=JSON.parse('{"title":"Github Actions","description":"","frontmatter":{"title":"Github Actions","date":"2024-02-10T00:00:00.000Z","tags":["健康",[null]],"categories":["健康生活"],"sticky":3},"headers":[],"relativePath":"vitepress/Github Actions + Github Pages 自动发布 Vue3 + Vite 项目.md","filePath":"vitepress/Github Actions + Github Pages 自动发布 Vue3 + Vite 项目.md"}'),t={name:"vitepress/Github Actions + Github Pages 自动发布 Vue3 + Vite 项目.md"};function l(e,s,h,k,c,r){return n(),a("div",null,s[0]||(s[0]=[p(`<h1 id="github-actions-github-pages-自动发布-vue3-vite-项目" tabindex="-1">Github Actions + Github Pages 自动发布 Vue3 + Vite 项目 <a class="header-anchor" href="#github-actions-github-pages-自动发布-vue3-vite-项目" aria-label="Permalink to &quot;Github Actions + Github Pages 自动发布 Vue3 + Vite 项目&quot;">​</a></h1><p>难度：★★★☆☆</p><blockquote><p>目的：提交代码，自动触发构建，并发布到 Github Pages 上</p></blockquote><blockquote><p>不详细讲为什么，只讲在怎么做</p></blockquote><h1 id="项目准备" tabindex="-1">项目准备 <a class="header-anchor" href="#项目准备" aria-label="Permalink to &quot;项目准备&quot;">​</a></h1><ol><li>先在<code>github</code>上准备一个前端项目，我使用<code>vue3</code>搭建了一个前端项目，技术栈为：<code>vue3、vite、element-plus、pinia、vue-router、headlessui、tailwindcss、typescript</code></li></ol><p>如何搭建可看这篇：<a href="https://juejin.cn/spost/7346720393425715219" target="_blank" rel="noreferrer">《vue3 + vite + element-plus + tailwindcss + typescript 实战项目》</a></p><ol><li>前端项目情况：只有<code>main</code>分支；项目文件如下图，代码<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMrHzq%2Fvue3-vite-element-plus-tailwindcss-typescript" target="_blank" rel="noreferrer">在这</a></li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/062cd4f6e67043c7bfdf2819a011828e~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=614768&amp;e=png&amp;b=ffffff" alt="img"></p><h1 id="github-pages-配置" tabindex="-1">Github Pages 配置 <a class="header-anchor" href="#github-pages-配置" aria-label="Permalink to &quot;Github Pages 配置&quot;">​</a></h1><p>可以理解为免费的线上服务器，可展示 build 后的前端项目</p><ol><li>开启配置</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae8e484735ea46e4993196674e6957af~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=498578&amp;e=png&amp;b=ffffff" alt="img"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/676ad4616a0243b2aa3295193906e53c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=498518&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>开启配置后，再刷新下页面（没有的话可强刷、关闭重进），可以看到访问地址</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64e7f68eff21440294bd3394a272f363~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=527774&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>访问下地址，发现页面是空白的，打开控制台，发现有 html 结构，原因是：会默认加载了该 github 项目下根目录的 index.html 文件</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6121bb80193a4c13ac8ece97de87d515~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=497475&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>现在去改一下该 github 项目根目录的 index.html 文件，加个点文字，然后提交代码</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c1f782ab4fe444bba73063efa38899c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2944&amp;h=456&amp;s=99282&amp;e=png&amp;b=fffefe" alt="img"> 等个 1、2 分钟，再刷新访问网址，就能看到最新的内容 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6b25e2129c949c78cd7945a85f3fcb7~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2412&amp;h=1838&amp;s=407190&amp;e=png&amp;b=fefdfd" alt="img"></p><ol><li>至此简单的 github pages 配置完成，可以放只有一个 .html 的在线简历</li></ol><h1 id="github-actions-配置" tabindex="-1">Github Actions 配置 <a class="header-anchor" href="#github-actions-配置" aria-label="Permalink to &quot;Github Actions 配置&quot;">​</a></h1><p>可以理解为 CI、CD</p><p>入门文档可看这篇：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Fgetting-started-with-github-actions.html" target="_blank" rel="noreferrer">GitHub Actions 入门教程 - 阮一峰的网络日志</a></p><p>可以配合上面的 Github Pages，实现提交代码，自动构建并发布的效果。</p><ol><li>更改<code>Github Pages</code>配置，改为<code>Github Actions</code>形式</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79df450fef54435a9b8de1074e4ff10f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=574971&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>创建<code>Github Actions</code>的配置</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86482575beab49f0bee8a8b8770267d1~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=537177&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>会帮我们生成了一个最基本的配置，然后我们提交到<code>mian</code>分支上</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/596d647d1c1640ec82b03b91400c772a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=752153&amp;e=png&amp;b=ffffff" alt="img"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a213dd6e63f4c1faa1656dc51b300c9~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=759069&amp;e=png&amp;b=8d9092" alt="img"></p><ol><li>提交后，我们进入<code>Actions</code>下，可看到第一个<code>workflows</code></li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23f33e4a55244b1f92ff2e89851db9c8~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=421696&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>现在去改一下该 github 项目根目录的 index.html 文件，再加点文字，然后提交代码</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/983b0aa7062d46eeb7c02f53de2fc7ef~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=408329&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>然后去<code>Actions</code>下，看又有了一个<code>workflow</code></li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a787476ceef1420fbae4eabfac19f7c2~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=392703&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>然后等它成功后，访问下该项目的 Github Pages，看到内容也变化了</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aed9f24f4d154641be9707402cae8f52~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1166&amp;h=542&amp;s=30434&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>至此简单的 github actions 配置完成，结合 github pages 可以放只有一个 .html 的在线简历，实现提交代码自动部署功能（虽然没啥用）</li></ol><h1 id="vue3-vite-项目接入" tabindex="-1">Vue3 + Vite 项目接入 <a class="header-anchor" href="#vue3-vite-项目接入" aria-label="Permalink to &quot;Vue3 + Vite 项目接入&quot;">​</a></h1><p>上面的流程比较简单，真正的项目是需要：提交代码后，触发构建、生成 dist、部署 dist，最终实现页面内容的更新</p><blockquote><p>本次项目的线上代码地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMrHzq%2Fvue3-vite-element-plus-tailwindcss-typescript" target="_blank" rel="noreferrer">在这</a></p></blockquote><ol><li>将项目拉取到本地：<code>git clone xxx</code></li><li>先在本地跑下构建命令，确定没得问题</li><li>更改<code>vite.config.ts</code>配置，将打包目录改为 github 项目目录</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e85707e0438143d3889ad31d0c9f2fa0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2584&amp;h=1228&amp;s=235092&amp;e=png&amp;b=282a35" alt="img"></p><ol><li>更改<code>.github/workflows/static.yml</code>配置，加入打包流程：</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b310815f91034115ba0dc80791355f7a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2796&amp;h=1574&amp;s=510244&amp;e=png&amp;b=2a2d37" alt="img"></p><ol><li>完整代码如下（pnpm 版）：</li></ol><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yml 代码解读复制代码# Simple workflow for deploying static content to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy static content to Pages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Runs on pushes targeting the default branch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Allows you to run this workflow manually from the Actions tab</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  contents</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">read</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  id-token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">concurrency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pages&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  cancel-in-progress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Single deploy job since we&#39;re just deploying</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">github-pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ steps.deployment.outputs.page_url }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm/action-setup@v2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Setup Node</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/setup-node@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          node-version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pnpm&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Install dependencies</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm install</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Build</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pnpm run build</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Setup Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/configure-pages@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Upload artifact</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/upload-pages-artifact@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Upload entire repository</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./dist&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">deployment</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/deploy-pages@v4</span></span></code></pre></div><ol><li>完整代码如下（npm 版）：</li></ol><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yml 代码解读复制代码# Simple workflow for deploying static content to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy static content to Pages</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Runs on pushes targeting the default branch</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    branches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Allows you to run this workflow manually from the Actions tab</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  workflow_dispatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">permissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  contents</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">read</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">write</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  id-token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">concurrency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pages&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  cancel-in-progress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jobs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Single deploy job since we&#39;re just deploying</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">github-pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\${{ steps.deployment.outputs.page_url }}</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    runs-on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    steps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Setup Node</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/setup-node@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          node-version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          cache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;npm&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Install dependencies</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">npm install</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Build</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">npm run build</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Setup Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/configure-pages@v4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Upload artifact</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/upload-pages-artifact@v3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Upload entire repository</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./dist&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Deploy to GitHub Pages</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">deployment</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/deploy-pages@v4</span></span></code></pre></div><ol><li>提交一下代码，然后去看<code>Actions</code>状态</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21d66353fa93427a94e61a52fdf5a593~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=445456&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>如果觉得频繁跳到 github 麻烦，可以安装 VScode 插件：<a href="https://link.juejin.cn?target=https%3A%2F%2Fmarketplace.visualstudio.com%2Fitems%3FitemName%3DGitHub.vscode-github-actions" target="_blank" rel="noreferrer">GitHub Actions</a>，然后在 VScode 里面直接看，并且还可点击直接打开网页的<code>github actions</code>内</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/943d3599cd1141b5ad8e3cded9d52980~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2886&amp;h=1732&amp;s=550775&amp;e=png&amp;b=272833" alt="img"></p><ol><li>actions 成功后，打开项目的 github pages 访问地址，看看是否对了，已经对了</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d18ec250395043ffb1c612d3ba2d0a40~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=445820&amp;e=png&amp;b=fffefe" alt="img"></p><ol><li>然后点点页面，跳转下路由，都是对的</li><li>但是刷新下发现就 404 了，这不是浪费感情吗？</li></ol><p>别急，这个原因是前端项目采用了<code>history</code>的路由模式，对<code>github pages</code>来说，访问<code>https://mrhzq.github.io/vue3-vite-element-plus-tailwindcss-typescript/about</code>是访问<code>/about</code>目录下的<code>index.html</code></p><p>但我们哪有<code>/about</code>目录，所以就去找访问目录(我们配的<code>/dist</code>)下的<code>404.html</code>，没找到就显示官方的 404 页面</p><h1 id="问题处理" tabindex="-1">问题处理 <a class="header-anchor" href="#问题处理" aria-label="Permalink to &quot;问题处理&quot;">​</a></h1><h2 id="github-pages-刷新后-页面-404" tabindex="-1">Github Pages 刷新后，页面 404 <a class="header-anchor" href="#github-pages-刷新后-页面-404" aria-label="Permalink to &quot;Github Pages 刷新后，页面 404&quot;">​</a></h2><blockquote><p>原因上面一行就有写，不赘述；正确的处理方式是：配置 nginx，将其他路径的访问全部都指向 index.html。但 Github Pages 我们没法这样去处理，所以只能“取巧”</p></blockquote><p>1、前端项目采用<code>hash</code>模式，重新触发<code>actions</code>后，就完全正常了，但<strong>地址就不好看，看个人选择</strong>。只需改路由就行，然后提交代码，等<code>actions</code>成功，就可以任意刷新</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6d4d8ebb70a54544ab9191183f951b8a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2730&amp;h=1110&amp;s=285541&amp;e=png&amp;b=292b36" alt="img"></p><p>2、在访问目录(我们配的<code>/dist</code>)下的创建一个<code>404.html</code>，内容跟<code>index.html</code>一模一样，这样显示<code>404.html</code>时也跟正常显示<code>index.html</code>一样</p><blockquote><p>我们可以在打包成功了，复制下<code>index.html</code>，命名为<code>404.html</code>就行</p></blockquote><p>a、<code>package.json</code>新增一个<code>404build</code>命令，用于生成<code>404.html</code></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">json 代码解读复制代码{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;404build&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cp dist/index.html dist/404.html&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>b、<code>.github/workflows/static.yml</code>新增一个<code>404Build</code>步骤</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60499003a0b94769beda257984222e85~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2438&amp;h=1308&amp;s=292387&amp;e=png&amp;b=282a35" alt="img"></p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">yml 代码解读复制代码- name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">404Build</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">npm run 404build</span></span></code></pre></div><p>c、提交代码，等<code>actions</code>成功，就可以任意刷新</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c53a0a975a8411b8e496995d266c26b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=551982&amp;e=png&amp;b=ffffff" alt="img"></p><h2 id="github-actions-失败处理" tabindex="-1">Github Actions 失败处理 <a class="header-anchor" href="#github-actions-失败处理" aria-label="Permalink to &quot;Github Actions 失败处理&quot;">​</a></h2><p>失败的，github 会发邮件给你哦</p><ol><li>找到失败的</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69e6633656434fbab5aebfbf7090d59c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=471618&amp;e=png&amp;b=ffffff" alt="img"></p><ol><li>进入详情</li></ol><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/432a03fc67af4132ba27a340eed378b0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=375931&amp;e=png&amp;b=ffffff" alt="img"></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f05ea983a1341df9f5eb94203931fa9~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3024&amp;h=1890&amp;s=441298&amp;e=png&amp;b=262a2f" alt="img"></p><h3 id="报错-supported-file-patterns-package-lock-json-npm-shrinkwrap-json-yarn-lock" tabindex="-1">报错：Supported file patterns: package-lock.json,npm-shrinkwrap.json,yarn.lock <a class="header-anchor" href="#报错-supported-file-patterns-package-lock-json-npm-shrinkwrap-json-yarn-lock" aria-label="Permalink to &quot;报错：Supported file patterns: package-lock.json,npm-shrinkwrap.json,yarn.lock&quot;">​</a></h3><p>因为我使用的是 pnpm，所以项目中没有 package-lock.json 文件。</p><p>处理方式：<code>npm i</code>，生成一个<code>package-lock.json</code>然后提交代码</p><p>作者：前端黄先森 链接：<a href="https://juejin.cn/post/7346524071185006611" target="_blank" rel="noreferrer">https://juejin.cn/post/7346524071185006611</a> 来源：稀土掘金 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>`,84)]))}const o=i(t,[["render",l]]);export{E as __pageData,o as default};
